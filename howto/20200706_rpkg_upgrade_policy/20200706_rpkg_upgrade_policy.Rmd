---
title: "R-Package Upgrade Policy"
author: "Peter von Rohr"
date: "7/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Disclaimer
A policy for the upgrade process of R-packages is defined. 


## Current Status
A set of R-packages (Rpkgs) is installed during the post-installation step of the installation process of a container image on the server. The packages are installed by user 'zws' into the library directory which is local to every server in '/home/zws/lib/R/library'. The advantage of this configuration is that packages can be installed just in time when they are required. The problem is that it is almost impossible to prevent unwanted updates of such locally installed packages.


## Problem
One of the problem of the above configuration is that it is impossible to enforce that packages are kept at their initial version of their first installation. An instance of this problem occurred in the SNP-preparation process. As it turned out, the SNP-preparation process has an increased run-time when the R-package 'dplyr' is updated from version '0.8.4' to version '1.0.0'. As a consequence, we want to temporarily freeze the version of the R-package 'dplyr' to '0.8.4'. This means that any attempt of updating R-packages must leave the R-package 'dplyr' at version '0.8.4'. 


## Background
The solution described in the section below, uses different features of the R-package system. A good reference for the R-package system is http://r-pkgs.had.co.nz/. 

When running R interactively or when running an R-script without specifying the option '--vanilla', the R-system is looking for installed R-packages in different places. These places are defined by a vector of different directories. This vector is obtained by the R-command

```{r, eval=FALSE}
.libPaths()
```

On an R-system as it comes out of the box, the above commands returns

```
> .libPaths()
[1] "/usr/local/lib/R/site-library" "/usr/lib/R/site-library"      
[3] "/usr/lib/R/library"  
```

The library search path as obtained by the above command, can be changed by the same command '.libPaths(new)' by giving the new search path as argument 'new'. This mechanism is by specifying a library search path in the '.Rprofile' startup file. 

In case, we want to run different images on the same host, we have to specify for each image a different local R library search path. This can be done by including the name of the container image into the local R library search path. This must already be setup in the container post-installation step.


## Solution

